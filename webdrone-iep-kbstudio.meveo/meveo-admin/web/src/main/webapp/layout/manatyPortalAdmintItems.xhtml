<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:o="http://omnifaces.org/ui"
                xmlns:p="http://primefaces.org/ui">

    <o:importFunctions type="org.meveo.commons.utils.ParamBean" var="paramBean" />
    <c:set var="cetIndex" value="0" />
    <c:forEach items="#{customEntityTemplateBean.listMenuCustomEntities()}" var="menu">
        <c:if test="#{not empty menu.key}">
            <p:submenu label="#{menu.key}">
                <c:forEach items="#{menu.value}" var="cet">
                    <c:if test="#{currentUser.hasRole(cet.readPermission)}">
                        <c:set var="storeAsTable" value="#{cet.sqlStorageConfiguration != null and cet.sqlStorageConfiguration.storeAsTable}" />
                        <p:menuitem id="cet_#{cetIndex}" outcome="#{storeAsTable ? 'customTables' : 'customEntities'}" value="#{cet.name}">
                            <f:param name="cet" value="#{cet.code}" disable="#{storeAsTable}"/>
                            <f:param name="objectId" value="#{cet.id}" disable="#{!storeAsTable}"/>
                        </p:menuitem>
                        <c:set var="cetIndex" value="#{cetIndex + 1}" />
                    </c:if>
                </c:forEach>
            </p:submenu>
        </c:if>
    </c:forEach>
    <c:forEach items="#{customEntityTemplateBean.listMenuCustomEntities()}" var="menu">
        <c:if test="#{empty menu.key}">
            <c:forEach items="#{menu.value}" var="cet">
                <c:if test="#{currentUser.hasRole(cet.readPermission)}">
                    <c:set var="storeAsTable" value="#{cet.sqlStorageConfiguration != null and cet.sqlStorageConfiguration.storeAsTable}" />
                    <p:menuitem id="cet_#{cetIndex}" outcome="#{storeAsTable ? 'customTables' : 'customEntities'}" value="#{cet.name}" rendered="#{cet.name =='Projects' or cet.name =='Clients'}">
                        <f:param name="cet" value="#{cet.code}"></f:param>
                    </p:menuitem>
                    <c:set var="cetIndex" value="#{cetIndex + 1}" />
                </c:if>
            </c:forEach>
        </c:if>
    </c:forEach>
    <p:menuitem id="users" value="#{messages['menu.users']}"
                outcome="users"
                rendered="#{currentUser.hasRole('ManatyPortalAdmin')}" />
</ui:composition>